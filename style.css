const heapdump = require('heapdump');

app.get('/debug/heapdump', (req, res) => {
  const filename = `/tmp/heapdump-${Date.now()}.heapsnapshot`;
  heapdump.writeSnapshot(filename, (err, filename) => {
    if (err) {
      console.error('Heap dump failed:', err);
      res.status(500).send('Heap dump failed');
    } else {
      res.download(filename);
    }
  });
});
